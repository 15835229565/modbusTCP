<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Modbustcp by stephanstricker</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Modbustcp</h1>
          <h2>Visual Studio modbusTCP class</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/stephanstricker/modbusTCP/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/stephanstricker/modbusTCP/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/stephanstricker/modbusTCP" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p>This class implements a Modbus TCP master driver for Windows in C#.</p>

<p><a href="https://github.com/stephanstricker/modbusTCP/blob/master/Screenshot.png">Screenshot</a></p>

<h2>
<a id="it-supports-the-following-function-codes" class="anchor" href="#it-supports-the-following-function-codes" aria-hidden="true"><span class="octicon octicon-link"></span></a>It supports the following function codes:</h2>

<ul>
<li>Read coils</li>
<li>Read discrete inputs</li>
<li>Write single coil</li>
<li>Write multiple coils</li>
<li>Read holding register</li>
<li>Read input register</li>
<li>Write single register</li>
<li>Write multiple registers</li>
</ul>

<p>Background
I will not explain how the Modbus protocol works in detail because there is plenty of information available online.</p>

<p><a href="http://www.modbus.org/">Modbus IDA home page</a></p>

<p><a href="http://www.modbus.org/docs/Modbus_Messaging_Implementation_Guide_V1_0a.pdf">Modbus IDA PDF documentation</a></p>

<h2>
<a id="using-the-code" class="anchor" href="#using-the-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using the code</h2>

<p>All commands are sent in synchronous or asynchronous mode. If a value is accessed in synchronous mode, the program will stop and wait for the slave to respond. If the slave does not answer within a specified time, a timeout exception is called. The class uses multi-threading for both synchronous and asynchronous access. The class opens two communication channels for each slave. This is necessary because the synchronous thread has to wait for a command to finish. This would block the asynchronous connection. The class directory contains a help file (ModbusClassTCP\doc) with detailed information for every function.</p>

<p>A sample application is included in the package that shows the basic features. It uses asynchronous mode for all function calls. The sample has some additional code to make the result handling more comfortable.</p>

<h2>
<a id="points-of-interest" class="anchor" href="#points-of-interest" aria-hidden="true"><span class="octicon octicon-link"></span></a>Points of Interest</h2>

<p>Remember that a lot of Modbus clients use a watchdog telegram to make sure the master is still active. If you donâ€™t call this watchdog within a specified time, the slave will close the connection. This feature is used to avoid unused open ports when the connection is interrupted.</p>

<h2>
<a id="history" class="anchor" href="#history" aria-hidden="true"><span class="octicon octicon-link"></span></a>History</h2>

<p>Version 3.3 (6/14/2013)</p>

<ul>
<li>Fixed: ID high and low byte swapped</li>
<li>Added: Modbus parameter UNIT added to function calls</li>
</ul>

<p>Version 3.2</p>

<p>First release</p>
        </section>

        <footer>
          Modbustcp is maintained by <a href="https://github.com/stephanstricker">stephanstricker</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
